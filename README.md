<img align="right" src="./resources/ludii-logo-64x64.png">

# Ludii C++ AI

[![license](https://img.shields.io/github/license/Ludeme/Ludii_AI_Cpp)](LICENSE)
![Maintenance](https://img.shields.io/badge/Maintained%3F-yes-green.svg)
[![twitter](https://img.shields.io/twitter/follow/ludiigames?style=social)](https://twitter.com/intent/follow?screen_name=ludiigames)

This repository contains information and an example for implementing general-game-playing AIs in C++, with a Java wrapper around them, such that they can subsequently be used in the Java-based Ludii General Game System.

- For general information on implementing AIs for Ludii (not in C++), see: https://github.com/Ludeme/LudiiExampleAI
- For general tutorials about Ludii, see: https://ludiitutorials.readthedocs.io

## Requirements

- Java version 8 or higher (including JDK)
- The G++ compiler for C++ code (or another compiler if you like, but instructions here are provided for G++).
- Version 1.3.9 or later of [Ludii](https://ludii.games/download.php)

## Getting Started

This repository contains a mix of Java and C++ code. The C++ code implements an actual AI algorithm (in the case of this repo, an example implementation of UCT). The Java implements the interface that Ludii expects.

### Java Code

The Java code of this repository can be found under [/src/ludii_cpp_ai/](/src/ludii_cpp_ai/). Compiling this code requires [Ludii's JAR file](https://ludii.games/download.php) to be set up as a dependency. There are two source files here:

1. [/src/ludii_cpp_ai/LudiiCppAI.java](/src/ludii_cpp_ai/LudiiCppAI.java): this file extends the `AI` abstract class, which Ludii requires to recognise the class as an AI that can play its games. It contains a static code block that will try to load and initialise a native library (with our C++ code), and overrides various Java methods from the `AI` abstract class with simple one-liners that delegate to native code.
2. [/src/ludii_cpp_ai/Main.java](/src/ludii_cpp_ai/Main.java): this file provides a simple main method that will register our C++-based AI in Ludii's registry of AIs, and then launch its GUI. When Ludii's GUI is launched in this way, the C++ AI will be available for selection in its dropdown menus for selecting AIs.

### C++ Code

The C++ code of this repository can be found under [/native/src](/native/src). This implements the actual AI algorithm (an example implementation of UCT is provided). Most (probably all) AI algorithms will require calling back into Ludii's Java code, for example to copy game states / apply moves to states / query legal moves from states / etc. in tree search algorithms. Calling into Ludii's Java code is done using [Java Native Interface (JNI)](https://en.wikipedia.org/wiki/Java_Native_Interface). The following two source files are included:

1. [/native/src/ludii_cpp_ai_LudiiCppAI.h](/native/src/ludii_cpp_ai_LudiiCppAI.h): this header file is **not written by hand**. It is **automatically generated**, using [a procedure described further down below](#generating-headers-for-native-code), from the Java code mentioned above. If, for your own AI, you were to modify the Java file, you would likely also want to take the same steps to automatically generate an updated version of this header file.
2. [/native/src/ludii_cpp_ai_LudiiCppAI.cpp](/native/src/ludii_cpp_ai_LudiiCppAI.cpp): this file provides implementation for the native methods, and includes the actual AI algorithm. Note that this involves frequent communication with Ludii's Java codebase through JNI, which also involves very careful memory management and exception checking.

## Generating Headers for Native Code

For this example, the header files for native code were automatically generated by running the following command (which, at the same time, also compiles our Java code). This is run from the root directory of the project, and assumes that Ludii's main `jar` file has been put in the `/libs` directory. It puts the
compiled Java class files in `/bin`, and the headers for native code in `/native/src`:

```
javac -cp ./libs/*.jar -d ./bin ./src/ludii_cpp_ai/LudiiCppAI.java -h ./native/src
```

## Compiling the C++ Code

We run the following command to compile the C++ code, and put the compiled object in `/native/bin`:

**Linux:**
```
g++ -c -fPIC -I${JAVA_HOME}/include -I${JAVA_HOME}/include/linux ./native/src/ludii_cpp_ai_LudiiCppAI.cpp -o ./native/bin/ludii_cpp_ai_LudiiCppAI.o
```

**Windows:**
```
g++ -c -I"%JAVA_HOME%\include" -I"%JAVA_HOME%\include\win32" ./native/src/ludii_cpp_ai_LudiiCppAI.cpp -o ./native/bin/ludii_cpp_ai_LudiiCppAI.o
```

**MacOS (not tested!):**
```
g++ -c -fPIC -I${JAVA_HOME}/include -I${JAVA_HOME}/include/darwin ./native/src/ludii_cpp_ai_LudiiCppAI.cpp -o ./native/bin/ludii_cpp_ai_LudiiCppAI.o
```

## Building the Shared Library

We run the following command to build a shared library with native code that can be loaded from Java,
and put it in `/libs` (alongside Ludii's `jar` file):

**Linux:**
```
g++ -shared -fPIC -o ./libs/libLudiiCppAI.so ./native/bin/ludii_cpp_ai_LudiiCppAI.o -lc
```

**Windows:**
```
g++ -shared -o ./libs/LudiiCppAI.dll ./native/bin/ludii_cpp_ai_LudiiCppAI.o -Wl,--add-stdcall-alias
```

**MacOS (not tested!):**
```
g++ -dynamiclib -o ./libs/libLudiiCppAI.dylib ./native/bin/ludii_cpp_ai_LudiiCppAI.o -lc
```

## Citing Information

When using Ludii in any publications (for example for running experiments, or
for visual inspections of your agent's behaviour during development, etc.), 
please cite [our paper on the Ludii system](http://ecai2020.eu/papers/1248_paper.pdf).
This can be done using the following BibTeX entry:


	@inproceedings{Piette2020Ludii,
            author      = "{\'E}. Piette and D. J. N. J. Soemers and M. Stephenson and C. F. Sironi and M. H. M. Winands and C. Browne",
            booktitle   = "Proceedings of the 24th European Conference on Artificial Intelligence (ECAI 2020)",
            title       = "Ludii -- The Ludemic General Game System",
            pages       = "411-418",
            year        = "2020",
            editor      = "G. De Giacomo and A. Catala and B. Dilkina and M. Milano and S. Barro and A. Bugar√≠n and J. Lang",
            series      = "Frontiers in Artificial Intelligence and Applications",
            volume      = "325",
	        publisher   = "IOS Press"
        }

## Background Info

This repository contains information and examples for the development of C++-based
AI implementations, with a Java wrapper such that they can subsequently be loaded
into the Java-based Ludii General Game System.

This work, as well as the full Ludii system itself, are developed for the
Digital Ludeme Project. More info on the project and the system can be found on:

- http://www.ludeme.eu/
- http://ludii.games/

## Contact Info

The preferred method for getting help with troubleshooting, suggesting, or
requesting additional is [creating new Issues on the github repository](https://github.com/Ludeme/Ludii_AI_Cpp/issues).
Alternatively, the following email address may be used: `ludii(dot)games(at)gmail(dot)com`.

## Acknowledgements

This repository is part of the European Research Council-funded Digital Ludeme Project (ERC Consolidator Grant \#771292), being run by Cameron Browne at Maastricht University's Department of Advanced Computing Sciences. 

<a href="https://erc.europa.eu/"><img src="./resources/LOGO_ERC-FLAG_EU_.jpg" title="Funded by the European Research Council" alt="European Research Council Logo" height="384"></a>
